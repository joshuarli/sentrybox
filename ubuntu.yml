images:
  - location: "https://cloud-images.ubuntu.com/minimal/releases/noble/release/ubuntu-24.04-minimal-cloudimg-arm64.img"
    arch: aarch64

ssh:
  forwardAgent: true

vmType: vz
cpus: 4
memory: 8GiB
# will grow dynamically; QCOW2 remains sparse until written
disk: "64GiB"

mounts:
  - location: "/Users/josh/dev/ubuntu"
    mountPoint: /home/ubuntu
    writable: true

provision:
  - mode: system
    script: |
      #!/bin/bash
      set -eux

      apt-get update
      apt-get install -y --no-install-recommends git curl

      id ubuntu &>/dev/null || useradd -m -s /bin/bash ubuntu

      sudo -iu ubuntu bash <<'EOF'
      echo hi
      EOF

portForwards:
  - guestPortRange: [1, 65535]
    ignore: true

containerd:
  system: false
  user: false
